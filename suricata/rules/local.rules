# Local Network Monitoring Rules
# ==============================

# Local Network Traffic Monitoring
# -------------------------------
alert tcp any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"LOCAL Internal Network Access"; flow:established; classtype:policy-violation; sid:1000001; rev:1;)
alert tcp [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any -> any any (msg:"LOCAL Internal Network Outbound"; flow:established; classtype:policy-violation; sid:1000002; rev:1;)

# Local Service Monitoring
# ------------------------
alert tcp any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] 22 (msg:"LOCAL SSH Access to Internal Network"; flow:established; classtype:attempted-recon; sid:1000003; rev:1;)
alert tcp any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] 80 (msg:"LOCAL HTTP Access to Internal Network"; flow:established; classtype:attempted-recon; sid:1000004; rev:1;)
alert tcp any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] 443 (msg:"LOCAL HTTPS Access to Internal Network"; flow:established; classtype:attempted-recon; sid:1000005; rev:1;)

# Local Network Scanning
# ----------------------
alert tcp any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"LOCAL Internal Network Port Scan"; flow:stateless; flags:S; content:"|00|"; within:10; threshold:type both, track by_src, count 5, seconds 60; classtype:attempted-recon; sid:1000006; rev:1;)

# Local Network DoS
# -----------------
alert tcp any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"LOCAL Internal Network SYN Flood"; flow:stateless; flags:S; content:"|00|"; within:5; threshold:type both, track by_src, count 10, seconds 10; classtype:attempted-dos; sid:1000007; rev:1;)

# Local Network Web Attacks
# -------------------------
alert http any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"LOCAL SQL Injection to Internal Network"; flow:to_server,established; http.uri; content:"union select"; nocase; classtype:web-application-attack; sid:1000010; rev:1;)
alert http any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"LOCAL XSS to Internal Network"; flow:to_server,established; http.uri; content:"<script>"; nocase; classtype:web-application-attack; sid:1000011; rev:1;)
alert http any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"LOCAL Directory Traversal to Internal Network"; flow:to_server,established; http.uri; content:"../"; classtype:web-application-attack; sid:1000012; rev:1;)

# Local Network File Upload
# -------------------------
alert http any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"LOCAL File Upload to Internal Network"; flow:to_server,established; http.uri; content:".php"; classtype:web-application-attack; sid:1000016; rev:1;)
alert http any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"LOCAL File Upload to Internal Network"; flow:to_server,established; http.uri; content:".jsp"; classtype:web-application-attack; sid:1000017; rev:1;)
alert http any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"LOCAL File Upload to Internal Network"; flow:to_server,established; http.uri; content:".asp"; classtype:web-application-attack; sid:1000018; rev:1;)

# Local Network Information Disclosure
# -----------------------------------
alert http any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"LOCAL Info Disclosure to Internal Network"; flow:to_server,established; http.uri; content:"phpinfo"; classtype:web-application-attack; sid:1000019; rev:1;)
alert http any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"LOCAL Info Disclosure to Internal Network"; flow:to_server,established; http.uri; content:".git"; classtype:web-application-attack; sid:1000020; rev:1;)
alert http any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"LOCAL Info Disclosure to Internal Network"; flow:to_server,established; http.uri; content:".env"; classtype:web-application-attack; sid:1000021; rev:1;)

# Local Network Authentication Bypass
# -----------------------------------
alert http any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"LOCAL Auth Bypass to Internal Network"; flow:to_server,established; http.uri; content:"admin"; classtype:web-application-attack; sid:1000022; rev:1;)

# Local Network IoT/Embedded Device Attacks
# -----------------------------------------
alert tcp any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] 23 (msg:"LOCAL Telnet Access to Internal Network"; flow:established; classtype:attempted-recon; sid:1000027; rev:1;)
alert tcp any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] 21 (msg:"LOCAL FTP Access to Internal Network"; flow:established; classtype:attempted-recon; sid:1000028; rev:1;)
alert tcp any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] 3389 (msg:"LOCAL RDP Access to Internal Network"; flow:established; classtype:attempted-recon; sid:1000029; rev:1;)
alert tcp any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] 445 (msg:"LOCAL SMB Access to Internal Network"; flow:established; classtype:attempted-recon; sid:1000030; rev:1;)

# Local Network Data Exfiltration
# -------------------------------
alert tcp any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"LOCAL Large Data Transfer to Internal Network"; flow:established,to_server; threshold:type threshold, track by_src, count 1000000, seconds 60; classtype:data-leak; sid:1000034; rev:1;)

# Local Network Social Engineering
# --------------------------------
alert http any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"LOCAL Phishing Attempt to Internal Network"; flow:to_server,established; http.uri; content:"login.*bank"; nocase; classtype:social-engineering; sid:1000041; rev:1;)
alert http any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"LOCAL Phishing Attempt to Internal Network"; flow:to_server,established; http.uri; content:"login.*paypal"; nocase; classtype:social-engineering; sid:1000042; rev:1;)
alert http any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"LOCAL Phishing Attempt to Internal Network"; flow:to_server,established; http.uri; content:"login.*amazon"; nocase; classtype:social-engineering; sid:1000043; rev:1;)

# Local Network Cryptocurrency Mining
# -----------------------------------
alert tcp any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"LOCAL Crypto Mining Pool to Internal Network"; flow:established; content:"stratum+tcp"; classtype:bad-unknown; sid:1000044; rev:1;)
alert http any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] any (msg:"LOCAL Crypto Mining Pool to Internal Network"; flow:established; http.uri; content:"pool"; classtype:bad-unknown; sid:1000045; rev:1;)

# Local Network IoT Botnet Activity
# ---------------------------------
alert udp any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] 53 (msg:"LOCAL IoT DNS Amplification to Internal Network"; flow:stateless; content:"|00 01 00 01|"; within:5; threshold:type both, track by_src, count 50, seconds 10; classtype:attempted-dos; sid:1000046; rev:1;)

# Local Network Compliance and Audit Rules
# ----------------------------------------
alert tcp any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] 22 (msg:"LOCAL SSH Access Log to Internal Network"; flow:established; classtype:policy-violation; sid:1000053; rev:1;)
alert tcp any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] 3389 (msg:"LOCAL RDP Access Log to Internal Network"; flow:established; classtype:policy-violation; sid:1000054; rev:1;)
alert tcp any any -> [10.0.0.0/8,172.16.0.0/12,192.168.0.0/16] 21 (msg:"LOCAL FTP Access Log to Internal Network"; flow:established; classtype:policy-violation; sid:1000055; rev:1;)
